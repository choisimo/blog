# =============================================================================
# Blog Backend - Environment Configuration
# =============================================================================
# Copy to .env and fill in values
#
# =============================================================================

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------
APP_ENV=production
HOST=0.0.0.0
PORT=5080
TRUST_PROXY=1
LOG_LEVEL=info

# GitHub Repository Owner (for GHCR image pulls)
GITHUB_REPOSITORY_OWNER=choisimo

# -----------------------------------------------------------------------------
# Security: Backend Authentication Key
# -----------------------------------------------------------------------------
# Shared secret between gateway/proxy and backend
# Sent in X-Backend-Key header
# Generate with: openssl rand -hex 32
BACKEND_SECRET_KEY=

# Origin secret for terminal server WebSocket authentication
ORIGIN_SECRET_KEY=

# -----------------------------------------------------------------------------
# URLs & CORS
# -----------------------------------------------------------------------------
SITE_BASE_URL=https://noblog.nodove.com
API_BASE_URL=https://api.nodove.com
ALLOWED_ORIGINS=https://noblog.nodove.com,http://localhost:5173

# Optional public assets base URL (e.g. https://example.com/images). Defaults to SITE_BASE_URL/images
ASSETS_BASE_URL=

# Rate limiting
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=60000

# -----------------------------------------------------------------------------
# Consul Service Discovery (Optional)
# -----------------------------------------------------------------------------
# When enabled, config is loaded from Consul KV with environment fallback
# Consul KV schema: blog/config/*, blog/services/*
USE_CONSUL=false
CONSUL_HOST=consul
CONSUL_PORT=8500

# -----------------------------------------------------------------------------
# PostgreSQL Database
# -----------------------------------------------------------------------------
POSTGRES_DB=blog
POSTGRES_USER=blog
POSTGRES_PASSWORD=

# -----------------------------------------------------------------------------
# Redis Cache
# -----------------------------------------------------------------------------
REDIS_PASSWORD=
REDIS_URL=redis://redis:6379

# AI Worker Configuration (for async queue processing)
AI_WORKER_NAME=worker-1
AI_WORKER_BATCH_SIZE=1
AI_WORKER_BLOCK_TIME=5000

# -----------------------------------------------------------------------------
# AI Provider Configuration (LiteLLM Unified Gateway)
# -----------------------------------------------------------------------------
# All AI requests route through LiteLLM proxy.
# LiteLLM routes to GitHub Models using GITHUB_TOKEN.

# LiteLLM proxy URL (OpenAI SDK compatible)
AI_SERVER_URL=http://litellm:4000/v1
LITELLM_URL=http://litellm:4000

# Default model (must match model_name in litellm_config.yaml)
AI_DEFAULT_MODEL=gpt-4.1

# Async Mode: Route AI requests through Redis Streams
AI_ASYNC_MODE=false

# AI Rate Limiting
AI_RATE_LIMIT_WINDOW_MS=60000
AI_RATE_LIMIT_MAX=30

# -----------------------------------------------------------------------------
# JWT Configuration
# -----------------------------------------------------------------------------
JWT_EXPIRES_IN=12h
JWT_SECRET=

# -----------------------------------------------------------------------------
# GitHub Integration (Admin PR creation)
# -----------------------------------------------------------------------------
GITHUB_TOKEN=
GITHUB_REPO_OWNER=choisimo
GITHUB_REPO_NAME=blog
GIT_USER_NAME=CI Bot
GIT_USER_EMAIL=ci@example.com

# -----------------------------------------------------------------------------
# Admin Authentication
# -----------------------------------------------------------------------------
ADMIN_BEARER_TOKEN=
ADMIN_USERNAME=
ADMIN_PASSWORD=

# -----------------------------------------------------------------------------
# MinIO Object Storage (Optional)
# -----------------------------------------------------------------------------
MINIO_USER=minioadmin
MINIO_PASSWORD=

# -----------------------------------------------------------------------------
# Firecrawl Web Scraper (Optional)
# -----------------------------------------------------------------------------
FIRECRAWL_API_TOKEN=

# -----------------------------------------------------------------------------
# Terminal Server
# -----------------------------------------------------------------------------
SANDBOX_IMAGE=alpine:latest

# -----------------------------------------------------------------------------
# Monitoring (Optional - enable with --profile monitoring)
# -----------------------------------------------------------------------------
GRAFANA_PASSWORD=

# -----------------------------------------------------------------------------
# Admin Tools (Optional - enable with --profile admin)
# -----------------------------------------------------------------------------
PGADMIN_EMAIL=admin@example.com
PGADMIN_PASSWORD=
